# Frontend (SPA) - https://app.fidelidade.bastostech.top
app.fidelidade.bastostech.top {
    root * /home/fidelidade/frontend/dist
    try_files {path} /index.html
    encode zstd gzip
    file_server
    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    }
}

# Backend API + static/media - https://fidelidade.bastostech.top
fidelidade.bastostech.top {
    @static path /static/*
    handle @static {
        uri strip_prefix /static
        root * /home/fidelidade/data/staticfiles
        file_server
    }

    @media path /media/*
    handle @media {
        uri strip_prefix /media
        root * /home/fidelidade/data/media
        file_server
    }

    handle {
        reverse_proxy 127.0.0.1:8700
    }

    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    }
}
